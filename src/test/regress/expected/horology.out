--
-- HOROLOGY
--
SET DateStyle = 'Postgres, MDY';
SET
--
-- Test various input formats
--
SELECT timestamp with time zone '20011227 040506+08';
         timestamptz          
------------------------------
 Thu Dec 27 04:05:06 2001 CST
(1 row)

SELECT timestamp with time zone '20011227 040506-08';
         timestamptz          
------------------------------
 Thu Dec 27 20:05:06 2001 CST
(1 row)

SELECT timestamp with time zone '20011227 040506.789+08';
           timestamptz            
----------------------------------
 Thu Dec 27 04:05:06.789 2001 CST
(1 row)

SELECT timestamp with time zone '20011227 040506.789-08';
           timestamptz            
----------------------------------
 Thu Dec 27 20:05:06.789 2001 CST
(1 row)

SELECT timestamp with time zone '20011227T040506+08';
         timestamptz          
------------------------------
 Thu Dec 27 04:05:06 2001 CST
(1 row)

SELECT timestamp with time zone '20011227T040506-08';
         timestamptz          
------------------------------
 Thu Dec 27 20:05:06 2001 CST
(1 row)

SELECT timestamp with time zone '20011227T040506.789+08';
           timestamptz            
----------------------------------
 Thu Dec 27 04:05:06.789 2001 CST
(1 row)

SELECT timestamp with time zone '20011227T040506.789-08';
           timestamptz            
----------------------------------
 Thu Dec 27 20:05:06.789 2001 CST
(1 row)

SELECT timestamp with time zone '2001-12-27 04:05:06.789-08';
           timestamptz            
----------------------------------
 Thu Dec 27 20:05:06.789 2001 CST
(1 row)

SELECT timestamp with time zone '2001.12.27 04:05:06.789-08';
           timestamptz            
----------------------------------
 Thu Dec 27 20:05:06.789 2001 CST
(1 row)

SELECT timestamp with time zone '2001/12/27 04:05:06.789-08';
           timestamptz            
----------------------------------
 Thu Dec 27 20:05:06.789 2001 CST
(1 row)

SELECT timestamp with time zone '12/27/2001 04:05:06.789-08';
           timestamptz            
----------------------------------
 Thu Dec 27 20:05:06.789 2001 CST
(1 row)

-- should fail in mdy mode:
SELECT timestamp with time zone '27/12/2001 04:05:06.789-08';
psql:sql/horology.sql:22: ERROR:  date/time field value out of range: "27/12/2001 04:05:06.789-08"
LINE 1: SELECT timestamp with time zone '27/12/2001 04:05:06.789-08'...
                                        ^
HINT:  Perhaps you need a different "datestyle" setting.
set datestyle to dmy;
SET
SELECT timestamp with time zone '27/12/2001 04:05:06.789-08';
           timestamptz            
----------------------------------
 Thu 27 Dec 20:05:06.789 2001 CST
(1 row)

reset datestyle;
RESET
SELECT timestamp with time zone 'Y2001M12D27H04M05S06.789+08';
        timestamptz         
----------------------------
 2001-12-27 04:05:06.789+08
(1 row)

SELECT timestamp with time zone 'Y2001M12D27H04M05S06.789-08';
        timestamptz         
----------------------------
 2001-12-27 20:05:06.789+08
(1 row)

SELECT timestamp with time zone 'Y2001M12D27H04MM05S06.789+08';
        timestamptz         
----------------------------
 2001-12-27 04:05:06.789+08
(1 row)

SELECT timestamp with time zone 'Y2001M12D27H04MM05S06.789-08';
        timestamptz         
----------------------------
 2001-12-27 20:05:06.789+08
(1 row)

SELECT timestamp with time zone 'J2452271+08';
      timestamptz       
------------------------
 2001-12-27 00:00:00+08
(1 row)

SELECT timestamp with time zone 'J2452271-08';
      timestamptz       
------------------------
 2001-12-27 16:00:00+08
(1 row)

SELECT timestamp with time zone 'J2452271.5+08';
      timestamptz       
------------------------
 2001-12-27 12:00:00+08
(1 row)

SELECT timestamp with time zone 'J2452271.5-08';
      timestamptz       
------------------------
 2001-12-28 04:00:00+08
(1 row)

SELECT timestamp with time zone 'J2452271 04:05:06+08';
      timestamptz       
------------------------
 2001-12-27 04:05:06+08
(1 row)

SELECT timestamp with time zone 'J2452271 04:05:06-08';
      timestamptz       
------------------------
 2001-12-27 20:05:06+08
(1 row)

SELECT timestamp with time zone 'J2452271T040506+08';
      timestamptz       
------------------------
 2001-12-27 04:05:06+08
(1 row)

SELECT timestamp with time zone 'J2452271T040506-08';
      timestamptz       
------------------------
 2001-12-27 20:05:06+08
(1 row)

SELECT timestamp with time zone 'J2452271T040506.789+08';
        timestamptz         
----------------------------
 2001-12-27 04:05:06.789+08
(1 row)

SELECT timestamp with time zone 'J2452271T040506.789-08';
        timestamptz         
----------------------------
 2001-12-27 20:05:06.789+08
(1 row)

-- German/European-style dates with periods as delimiters
SELECT timestamp with time zone '12.27.2001 04:05:06.789+08';
psql:sql/horology.sql:41: ERROR:  date/time field value out of range: "12.27.2001 04:05:06.789+08"
LINE 1: SELECT timestamp with time zone '12.27.2001 04:05:06.789+08'...
                                        ^
HINT:  Perhaps you need a different "datestyle" setting.
SELECT timestamp with time zone '12.27.2001 04:05:06.789-08';
psql:sql/horology.sql:42: ERROR:  date/time field value out of range: "12.27.2001 04:05:06.789-08"
LINE 1: SELECT timestamp with time zone '12.27.2001 04:05:06.789-08'...
                                        ^
HINT:  Perhaps you need a different "datestyle" setting.
SET DateStyle = 'German';
SET
SELECT timestamp with time zone '27.12.2001 04:05:06.789+08';
         timestamptz         
-----------------------------
 27.12.2001 04:05:06.789 CST
(1 row)

SELECT timestamp with time zone '27.12.2001 04:05:06.789-08';
         timestamptz         
-----------------------------
 27.12.2001 20:05:06.789 CST
(1 row)

SET DateStyle = 'ISO';
SET
-- As of 7.4, allow time without time zone having a time zone specified
SELECT time without time zone '040506.789+08';
     time     
--------------
 04:05:06.789
(1 row)

SELECT time without time zone '040506.789-08';
     time     
--------------
 04:05:06.789
(1 row)

SELECT time without time zone 'T040506.789+08';
     time     
--------------
 04:05:06.789
(1 row)

SELECT time without time zone 'T040506.789-08';
     time     
--------------
 04:05:06.789
(1 row)

SELECT time with time zone '040506.789+08';
     timetz      
-----------------
 04:05:06.789+08
(1 row)

SELECT time with time zone '040506.789-08';
     timetz      
-----------------
 04:05:06.789-08
(1 row)

SELECT time with time zone 'T040506.789+08';
     timetz      
-----------------
 04:05:06.789+08
(1 row)

SELECT time with time zone 'T040506.789-08';
     timetz      
-----------------
 04:05:06.789-08
(1 row)

SELECT time with time zone 'T040506.789 +08';
     timetz      
-----------------
 04:05:06.789+08
(1 row)

SELECT time with time zone 'T040506.789 -08';
     timetz      
-----------------
 04:05:06.789-08
(1 row)

SET DateStyle = 'Postgres, MDY';
SET
-- Check Julian dates BC
SELECT date 'J1520447' AS "Confucius' Birthday";
 Confucius' Birthday 
---------------------
 09-28-0551 BC
(1 row)

SELECT date 'J0' AS "Julian Epoch";
 Julian Epoch  
---------------
 11-24-4714 BC
(1 row)

--
-- date, time arithmetic
--
SELECT date '1981-02-03' + time '04:05:06' AS "Date + Time";
       Date + Time        
--------------------------
 Tue Feb 03 04:05:06 1981
(1 row)

SELECT date '1991-02-03' + time with time zone '04:05:06 PST' AS "Date + Time PST";
       Date + Time PST        
------------------------------
 Sun Feb 03 20:05:06 1991 CST
(1 row)

SELECT date '2001-02-03' + time with time zone '04:05:06 UTC' AS "Date + Time UTC";
       Date + Time UTC        
------------------------------
 Sat Feb 03 12:05:06 2001 CST
(1 row)

SELECT date '1991-02-03' + interval '2 years' AS "Add Two Years";
      Add Two Years       
--------------------------
 Wed Feb 03 00:00:00 1993
(1 row)

SELECT date '2001-12-13' - interval '2 years' AS "Subtract Two Years";
    Subtract Two Years    
--------------------------
 Mon Dec 13 00:00:00 1999
(1 row)

-- subtract time from date should not make sense; use interval instead
SELECT date '1991-02-03' - time '04:05:06' AS "Subtract Time";
      Subtract Time       
--------------------------
 Sat Feb 02 19:54:54 1991
(1 row)

SELECT date '1991-02-03' - time with time zone '04:05:06 UTC' AS "Subtract Time UTC";
psql:sql/horology.sql:74: ERROR:  operator does not exist: date - time with time zone
LINE 1: SELECT date '1991-02-03' - time with time zone '04:05:06 UTC...
                                 ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
--
-- timestamp, interval arithmetic
--
SELECT timestamp without time zone '1996-03-01' - interval '1 second' AS "Feb 29";
          Feb 29          
--------------------------
 Thu Feb 29 23:59:59 1996
(1 row)

SELECT timestamp without time zone '1999-03-01' - interval '1 second' AS "Feb 28";
          Feb 28          
--------------------------
 Sun Feb 28 23:59:59 1999
(1 row)

SELECT timestamp without time zone '2000-03-01' - interval '1 second' AS "Feb 29";
          Feb 29          
--------------------------
 Tue Feb 29 23:59:59 2000
(1 row)

SELECT timestamp without time zone '1999-12-01' + interval '1 month - 1 second' AS "Dec 31";
          Dec 31          
--------------------------
 Fri Dec 31 23:59:59 1999
(1 row)

SELECT timestamp without time zone 'Jan 1, 4713 BC' + interval '106000000 days' AS "Feb 23, 285506";
       Feb 23, 285506       
----------------------------
 Fri Feb 23 00:00:00 285506
(1 row)

SELECT timestamp without time zone 'Jan 1, 4713 BC' + interval '107000000 days' AS "Jan 20, 288244";
       Jan 20, 288244       
----------------------------
 Sat Jan 20 00:00:00 288244
(1 row)

SELECT timestamp without time zone 'Jan 1, 4713 BC' + interval '109203489 days' AS "Dec 31, 294276";
       Dec 31, 294276       
----------------------------
 Sun Dec 31 00:00:00 294276
(1 row)

SELECT timestamp without time zone '12/31/294276' - timestamp without time zone '12/23/1999' AS "106751991 Days";
 106751991 Days 
----------------
 P106751991D
(1 row)

-- Shorthand values
-- Not directly usable for regression testing since these are not constants.
-- So, just try to test parser and hope for the best - thomas 97/04/26
SELECT (timestamp without time zone 'today' = (timestamp without time zone 'yesterday' + interval '1 day')) as "True";
 True 
------
 t
(1 row)

SELECT (timestamp without time zone 'today' = (timestamp without time zone 'tomorrow' - interval '1 day')) as "True";
 True 
------
 t
(1 row)

SELECT (timestamp without time zone 'today 10:30' = (timestamp without time zone 'yesterday' + interval '1 day 10 hr 30 min')) as "True";
 True 
------
 t
(1 row)

SELECT (timestamp without time zone '10:30 today' = (timestamp without time zone 'yesterday' + interval '1 day 10 hr 30 min')) as "True";
 True 
------
 t
(1 row)

SELECT (timestamp without time zone 'tomorrow' = (timestamp without time zone 'yesterday' + interval '2 days')) as "True";
 True 
------
 t
(1 row)

SELECT (timestamp without time zone 'tomorrow 16:00:00' = (timestamp without time zone 'today' + interval '1 day 16 hours')) as "True";
 True 
------
 t
(1 row)

SELECT (timestamp without time zone '16:00:00 tomorrow' = (timestamp without time zone 'today' + interval '1 day 16 hours')) as "True";
 True 
------
 t
(1 row)

SELECT (timestamp without time zone 'yesterday 12:34:56' = (timestamp without time zone 'tomorrow' - interval '2 days - 12:34:56')) as "True";
 True 
------
 t
(1 row)

SELECT (timestamp without time zone '12:34:56 yesterday' = (timestamp without time zone 'tomorrow' - interval '2 days - 12:34:56')) as "True";
 True 
------
 t
(1 row)

SELECT (timestamp without time zone 'tomorrow' > 'now') as "True";
 True 
------
 t
(1 row)

-- Convert from date and time to timestamp
-- This test used to be timestamp(date,time) but no longer allowed by grammar
-- to enable support for SQL99 timestamp type syntax.
SELECT date '1994-01-01' + time '11:00' AS "Jan_01_1994_11am";
     Jan_01_1994_11am     
--------------------------
 Sat Jan 01 11:00:00 1994
(1 row)

SELECT date '1994-01-01' + time '10:00' AS "Jan_01_1994_10am";
     Jan_01_1994_10am     
--------------------------
 Sat Jan 01 10:00:00 1994
(1 row)

SELECT date '1994-01-01' + timetz '11:00-5' AS "Jan_01_1994_8am";
       Jan_01_1994_8am        
------------------------------
 Sun Jan 02 00:00:00 1994 CST
(1 row)

SELECT timestamptz(date '1994-01-01', time with time zone '11:00-5') AS "Jan_01_1994_8am";
       Jan_01_1994_8am        
------------------------------
 Sun Jan 02 00:00:00 1994 CST
(1 row)

--SELECT '' AS "64", d1 + interval '1 year' AS one_year FROM TIMESTAMP_TBL;
--SELECT '' AS "64", d1 - interval '1 year' AS one_year FROM TIMESTAMP_TBL;
SELECT timestamp with time zone '1996-03-01' - interval '1 second' AS "Feb 29";
            Feb 29            
------------------------------
 Thu Feb 29 23:59:59 1996 CST
(1 row)

SELECT timestamp with time zone '1999-03-01' - interval '1 second' AS "Feb 28";
            Feb 28            
------------------------------
 Sun Feb 28 23:59:59 1999 CST
(1 row)

SELECT timestamp with time zone '2000-03-01' - interval '1 second' AS "Feb 29";
            Feb 29            
------------------------------
 Tue Feb 29 23:59:59 2000 CST
(1 row)

SELECT timestamp with time zone '1999-12-01' + interval '1 month - 1 second' AS "Dec 31";
            Dec 31            
------------------------------
 Fri Dec 31 23:59:59 1999 CST
(1 row)

SELECT (timestamp with time zone 'today' = (timestamp with time zone 'yesterday' + interval '1 day')) as "True";
 True 
------
 t
(1 row)

SELECT (timestamp with time zone 'today' = (timestamp with time zone 'tomorrow' - interval '1 day')) as "True";
 True 
------
 t
(1 row)

SELECT (timestamp with time zone 'tomorrow' = (timestamp with time zone 'yesterday' + interval '2 days')) as "True";
 True 
------
 t
(1 row)

SELECT (timestamp with time zone 'tomorrow' > 'now') as "True";
 True 
------
 t
(1 row)

-- timestamp with time zone, interval arithmetic around DST change
SET TIME ZONE 'CST7CDT';
SET
SELECT timestamp with time zone '2005-04-02 12:00-07' + interval '1 day' as "Apr 3, 12:00";
         Apr 3, 12:00         
------------------------------
 Sun Apr 03 12:00:00 2005 CDT
(1 row)

SELECT timestamp with time zone '2005-04-02 12:00-07' + interval '24 hours' as "Apr 3, 13:00";
         Apr 3, 13:00         
------------------------------
 Sun Apr 03 13:00:00 2005 CDT
(1 row)

SELECT timestamp with time zone '2005-04-03 12:00-06' - interval '1 day' as "Apr 2, 12:00";
         Apr 2, 12:00         
------------------------------
 Sat Apr 02 12:00:00 2005 CST
(1 row)

SELECT timestamp with time zone '2005-04-03 12:00-06' - interval '24 hours' as "Apr 2, 11:00";
         Apr 2, 11:00         
------------------------------
 Sat Apr 02 11:00:00 2005 CST
(1 row)

RESET TIME ZONE;
RESET
SELECT timestamptz(date '1994-01-01', time '11:00') AS "Jan_01_1994_10am";
       Jan_01_1994_10am       
------------------------------
 Sat Jan 01 11:00:00 1994 CST
(1 row)

SELECT timestamptz(date '1994-01-01', time '10:00') AS "Jan_01_1994_9am";
       Jan_01_1994_9am        
------------------------------
 Sat Jan 01 10:00:00 1994 CST
(1 row)

SELECT timestamptz(date '1994-01-01', time with time zone '11:00-8') AS "Jan_01_1994_11am";
       Jan_01_1994_11am       
------------------------------
 Sun Jan 02 03:00:00 1994 CST
(1 row)

SELECT timestamptz(date '1994-01-01', time with time zone '10:00-8') AS "Jan_01_1994_10am";
       Jan_01_1994_10am       
------------------------------
 Sun Jan 02 02:00:00 1994 CST
(1 row)

SELECT timestamptz(date '1994-01-01', time with time zone '11:00-5') AS "Jan_01_1994_8am";
       Jan_01_1994_8am        
------------------------------
 Sun Jan 02 00:00:00 1994 CST
(1 row)

--SELECT '' AS "64", d1 + interval '1 year' AS one_year FROM TIMESTAMPTZ_TBL;
--SELECT '' AS "64", d1 - interval '1 year' AS one_year FROM TIMESTAMPTZ_TBL;
--
-- time, interval arithmetic
--
SELECT CAST(time '01:02' AS interval) AS "+01:02";
 +01:02 
--------
 PT1H2M
(1 row)

SELECT CAST(interval '02:03' AS time) AS "02:03:00";
 02:03:00 
----------
 02:03:00
(1 row)

SELECT time '01:30' + interval '02:01' AS "03:31:00";
 03:31:00 
----------
 03:31:00
(1 row)

SELECT time '01:30' - interval '02:01' AS "23:29:00";
 23:29:00 
----------
 23:29:00
(1 row)

SELECT time '02:30' + interval '36:01' AS "14:31:00";
 14:31:00 
----------
 14:31:00
(1 row)

SELECT time '03:30' + interval '1 month 04:01' AS "07:31:00";
 07:31:00 
----------
 07:31:00
(1 row)

SELECT CAST(time with time zone '01:02-08' AS interval) AS "+00:01";
psql:sql/horology.sql:152: ERROR:  cannot cast type time with time zone to interval
LINE 1: SELECT CAST(time with time zone '01:02-08' AS interval) AS "...
               ^
SELECT CAST(interval '02:03' AS time with time zone) AS "02:03:00-08";
psql:sql/horology.sql:153: ERROR:  cannot cast type interval to time with time zone
LINE 1: SELECT CAST(interval '02:03' AS time with time zone) AS "02:...
               ^
SELECT time with time zone '01:30-08' - interval '02:01' AS "23:29:00-08";
 23:29:00-08 
-------------
 23:29:00-08
(1 row)

SELECT time with time zone '02:30-08' + interval '36:01' AS "14:31:00-08";
 14:31:00-08 
-------------
 14:31:00-08
(1 row)

-- These two tests cannot be used because they default to current timezone,
-- which may be either -08 or -07 depending on the time of year.
-- SELECT time with time zone '01:30' + interval '02:01' AS "03:31:00-08";
-- SELECT time with time zone '03:30' + interval '1 month 04:01' AS "07:31:00-08";
-- Try the following two tests instead, as a poor substitute
SELECT CAST(CAST(date 'today' + time with time zone '05:30'
            + interval '02:01' AS time with time zone) AS time) AS "07:31:00";
 07:31:00 
----------
 07:31:00
(1 row)

SELECT CAST(cast(date 'today' + time with time zone '03:30'
  + interval '1 month 04:01' as timestamp without time zone) AS time) AS "07:31:00";
 07:31:00 
----------
 07:31:00
(1 row)

-- SQL9x OVERLAPS operator
-- test with time zone
SELECT (timestamp with time zone '2000-11-27', timestamp with time zone '2000-11-28')
  OVERLAPS (timestamp with time zone '2000-11-27 12:00', timestamp with time zone '2000-11-30') AS "True";
 True 
------
 t
(1 row)

SELECT (timestamp with time zone '2000-11-26', timestamp with time zone '2000-11-27')
  OVERLAPS (timestamp with time zone '2000-11-27 12:00', timestamp with time zone '2000-11-30') AS "False";
 False 
-------
 f
(1 row)

SELECT (timestamp with time zone '2000-11-27', timestamp with time zone '2000-11-28')
  OVERLAPS (timestamp with time zone '2000-11-27 12:00', interval '1 day') AS "True";
 True 
------
 t
(1 row)

SELECT (timestamp with time zone '2000-11-27', interval '12 hours')
  OVERLAPS (timestamp with time zone '2000-11-27 12:00', timestamp with time zone '2000-11-30') AS "False";
 False 
-------
 f
(1 row)

SELECT (timestamp with time zone '2000-11-27', interval '12 hours')
  OVERLAPS (timestamp with time zone '2000-11-27', interval '12 hours') AS "True";
 True 
------
 t
(1 row)

SELECT (timestamp with time zone '2000-11-27', interval '12 hours')
  OVERLAPS (timestamp with time zone '2000-11-27 12:00', interval '12 hours') AS "False";
 False 
-------
 f
(1 row)

-- test without time zone
SELECT (timestamp without time zone '2000-11-27', timestamp without time zone '2000-11-28')
  OVERLAPS (timestamp without time zone '2000-11-27 12:00', timestamp without time zone '2000-11-30') AS "True";
 True 
------
 t
(1 row)

SELECT (timestamp without time zone '2000-11-26', timestamp without time zone '2000-11-27')
  OVERLAPS (timestamp without time zone '2000-11-27 12:00', timestamp without time zone '2000-11-30') AS "False";
 False 
-------
 f
(1 row)

SELECT (timestamp without time zone '2000-11-27', timestamp without time zone '2000-11-28')
  OVERLAPS (timestamp without time zone '2000-11-27 12:00', interval '1 day') AS "True";
 True 
------
 t
(1 row)

SELECT (timestamp without time zone '2000-11-27', interval '12 hours')
  OVERLAPS (timestamp without time zone '2000-11-27 12:00', timestamp without time zone '2000-11-30') AS "False";
 False 
-------
 f
(1 row)

SELECT (timestamp without time zone '2000-11-27', interval '12 hours')
  OVERLAPS (timestamp without time zone '2000-11-27', interval '12 hours') AS "True";
 True 
------
 t
(1 row)

SELECT (timestamp without time zone '2000-11-27', interval '12 hours')
  OVERLAPS (timestamp without time zone '2000-11-27 12:00', interval '12 hours') AS "False";
 False 
-------
 f
(1 row)

-- test time and interval
SELECT (time '00:00', time '01:00')
  OVERLAPS (time '00:30', time '01:30') AS "True";
 True 
------
 t
(1 row)

SELECT (time '00:00', interval '1 hour')
  OVERLAPS (time '00:30', interval '1 hour') AS "True";
 True 
------
 t
(1 row)

SELECT (time '00:00', interval '1 hour')
  OVERLAPS (time '01:30', interval '1 hour') AS "False";
 False 
-------
 f
(1 row)

-- SQL99 seems to want this to be false (and we conform to the spec).
-- istm that this *should* return true, on the theory that time
-- intervals can wrap around the day boundary - thomas 2001-09-25
SELECT (time '00:00', interval '1 hour')
  OVERLAPS (time '01:30', interval '1 day') AS "False";
 False 
-------
 f
(1 row)

  
CREATE TABLE TEMP_TIMESTAMP (f1 timestamp with time zone);
CREATE TABLE
-- get some candidate input values
INSERT INTO TEMP_TIMESTAMP (f1)
  SELECT d1 FROM TIMESTAMP_TBL
  WHERE d1 BETWEEN '13-jun-1957' AND '1-jan-1997'
   OR d1 BETWEEN '1-jan-1999' AND '1-jan-2010';
INSERT 0 16
SELECT '' AS "16", f1 AS "timestamp"
  FROM TEMP_TIMESTAMP
  ORDER BY "timestamp";
 16 |          timestamp           
----+------------------------------
    | Thu Jan 01 08:00:00 1970 CST
    | Thu Feb 29 01:32:01 1996 CST
    | Fri Mar 01 01:32:01 1996 CST
    | Sat Mar 02 01:32:01 1996 CST
    | Tue Dec 31 01:32:01 1996 CST
    | Wed Jan 01 01:32:01 1997 CST
    | Sat Jan 01 01:32:01 2000 CST
    | Sun Jan 02 01:32:01 2000 CST
    | Wed Mar 15 10:14:05 2000 CST
    | Wed Mar 15 11:14:04 2000 CST
    | Wed Mar 15 16:14:01 2000 CST
    | Wed Mar 15 20:14:03 2000 CST
    | Wed Mar 15 21:14:02 2000 CST
    | Mon Jan 01 01:32:01 2001 CST
    | Tue Jan 02 01:32:01 2001 CST
    | Sun Sep 23 02:19:20 2001 CST
(16 rows)

SELECT '' AS "16", d.f1 AS "timestamp",
   timestamp with time zone '1980-01-06 00:00 GMT' AS gpstime_zero,
   d.f1 - timestamp with time zone '1980-01-06 00:00 GMT' AS difference
  FROM TEMP_TIMESTAMP d
  ORDER BY difference;
 16 |          timestamp           |         gpstime_zero         |    difference    
----+------------------------------+------------------------------+------------------
    | Thu Jan 01 08:00:00 1970 CST | Sun Jan 06 08:00:00 1980 CST | P-3657D
    | Thu Feb 29 01:32:01 1996 CST | Sun Jan 06 08:00:00 1980 CST | P5897DT17H32M1S
    | Fri Mar 01 01:32:01 1996 CST | Sun Jan 06 08:00:00 1980 CST | P5898DT17H32M1S
    | Sat Mar 02 01:32:01 1996 CST | Sun Jan 06 08:00:00 1980 CST | P5899DT17H32M1S
    | Tue Dec 31 01:32:01 1996 CST | Sun Jan 06 08:00:00 1980 CST | P6203DT17H32M1S
    | Wed Jan 01 01:32:01 1997 CST | Sun Jan 06 08:00:00 1980 CST | P6204DT17H32M1S
    | Sat Jan 01 01:32:01 2000 CST | Sun Jan 06 08:00:00 1980 CST | P7299DT17H32M1S
    | Sun Jan 02 01:32:01 2000 CST | Sun Jan 06 08:00:00 1980 CST | P7300DT17H32M1S
    | Wed Mar 15 10:14:05 2000 CST | Sun Jan 06 08:00:00 1980 CST | P7374DT2H14M5S
    | Wed Mar 15 11:14:04 2000 CST | Sun Jan 06 08:00:00 1980 CST | P7374DT3H14M4S
    | Wed Mar 15 16:14:01 2000 CST | Sun Jan 06 08:00:00 1980 CST | P7374DT8H14M1S
    | Wed Mar 15 20:14:03 2000 CST | Sun Jan 06 08:00:00 1980 CST | P7374DT12H14M3S
    | Wed Mar 15 21:14:02 2000 CST | Sun Jan 06 08:00:00 1980 CST | P7374DT13H14M2S
    | Mon Jan 01 01:32:01 2001 CST | Sun Jan 06 08:00:00 1980 CST | P7665DT17H32M1S
    | Tue Jan 02 01:32:01 2001 CST | Sun Jan 06 08:00:00 1980 CST | P7666DT17H32M1S
    | Sun Sep 23 02:19:20 2001 CST | Sun Jan 06 08:00:00 1980 CST | P7930DT18H19M20S
(16 rows)

SELECT '' AS "226", d1.f1 AS timestamp1, d2.f1 AS timestamp2, d1.f1 - d2.f1 AS difference
  FROM TEMP_TIMESTAMP d1, TEMP_TIMESTAMP d2
  ORDER BY timestamp1, timestamp2, difference;
 226 |          timestamp1          |          timestamp2          |      difference       
-----+------------------------------+------------------------------+-----------------------
     | Thu Jan 01 08:00:00 1970 CST | Thu Jan 01 08:00:00 1970 CST | PT0S
     | Thu Jan 01 08:00:00 1970 CST | Thu Feb 29 01:32:01 1996 CST | P-9554DT-17H-32M-1S
     | Thu Jan 01 08:00:00 1970 CST | Fri Mar 01 01:32:01 1996 CST | P-9555DT-17H-32M-1S
     | Thu Jan 01 08:00:00 1970 CST | Sat Mar 02 01:32:01 1996 CST | P-9556DT-17H-32M-1S
     | Thu Jan 01 08:00:00 1970 CST | Tue Dec 31 01:32:01 1996 CST | P-9860DT-17H-32M-1S
     | Thu Jan 01 08:00:00 1970 CST | Wed Jan 01 01:32:01 1997 CST | P-9861DT-17H-32M-1S
     | Thu Jan 01 08:00:00 1970 CST | Sat Jan 01 01:32:01 2000 CST | P-10956DT-17H-32M-1S
     | Thu Jan 01 08:00:00 1970 CST | Sun Jan 02 01:32:01 2000 CST | P-10957DT-17H-32M-1S
     | Thu Jan 01 08:00:00 1970 CST | Wed Mar 15 10:14:05 2000 CST | P-11031DT-2H-14M-5S
     | Thu Jan 01 08:00:00 1970 CST | Wed Mar 15 11:14:04 2000 CST | P-11031DT-3H-14M-4S
     | Thu Jan 01 08:00:00 1970 CST | Wed Mar 15 16:14:01 2000 CST | P-11031DT-8H-14M-1S
     | Thu Jan 01 08:00:00 1970 CST | Wed Mar 15 20:14:03 2000 CST | P-11031DT-12H-14M-3S
     | Thu Jan 01 08:00:00 1970 CST | Wed Mar 15 21:14:02 2000 CST | P-11031DT-13H-14M-2S
     | Thu Jan 01 08:00:00 1970 CST | Mon Jan 01 01:32:01 2001 CST | P-11322DT-17H-32M-1S
     | Thu Jan 01 08:00:00 1970 CST | Tue Jan 02 01:32:01 2001 CST | P-11323DT-17H-32M-1S
     | Thu Jan 01 08:00:00 1970 CST | Sun Sep 23 02:19:20 2001 CST | P-11587DT-18H-19M-20S
     | Thu Feb 29 01:32:01 1996 CST | Thu Jan 01 08:00:00 1970 CST | P9554DT17H32M1S
     | Thu Feb 29 01:32:01 1996 CST | Thu Feb 29 01:32:01 1996 CST | PT0S
     | Thu Feb 29 01:32:01 1996 CST | Fri Mar 01 01:32:01 1996 CST | P-1D
     | Thu Feb 29 01:32:01 1996 CST | Sat Mar 02 01:32:01 1996 CST | P-2D
     | Thu Feb 29 01:32:01 1996 CST | Tue Dec 31 01:32:01 1996 CST | P-306D
     | Thu Feb 29 01:32:01 1996 CST | Wed Jan 01 01:32:01 1997 CST | P-307D
     | Thu Feb 29 01:32:01 1996 CST | Sat Jan 01 01:32:01 2000 CST | P-1402D
     | Thu Feb 29 01:32:01 1996 CST | Sun Jan 02 01:32:01 2000 CST | P-1403D
     | Thu Feb 29 01:32:01 1996 CST | Wed Mar 15 10:14:05 2000 CST | P-1476DT-8H-42M-4S
     | Thu Feb 29 01:32:01 1996 CST | Wed Mar 15 11:14:04 2000 CST | P-1476DT-9H-42M-3S
     | Thu Feb 29 01:32:01 1996 CST | Wed Mar 15 16:14:01 2000 CST | P-1476DT-14H-42M
     | Thu Feb 29 01:32:01 1996 CST | Wed Mar 15 20:14:03 2000 CST | P-1476DT-18H-42M-2S
     | Thu Feb 29 01:32:01 1996 CST | Wed Mar 15 21:14:02 2000 CST | P-1476DT-19H-42M-1S
     | Thu Feb 29 01:32:01 1996 CST | Mon Jan 01 01:32:01 2001 CST | P-1768D
     | Thu Feb 29 01:32:01 1996 CST | Tue Jan 02 01:32:01 2001 CST | P-1769D
     | Thu Feb 29 01:32:01 1996 CST | Sun Sep 23 02:19:20 2001 CST | P-2033DT-47M-19S
     | Fri Mar 01 01:32:01 1996 CST | Thu Jan 01 08:00:00 1970 CST | P9555DT17H32M1S
     | Fri Mar 01 01:32:01 1996 CST | Thu Feb 29 01:32:01 1996 CST | P1D
     | Fri Mar 01 01:32:01 1996 CST | Fri Mar 01 01:32:01 1996 CST | PT0S
     | Fri Mar 01 01:32:01 1996 CST | Sat Mar 02 01:32:01 1996 CST | P-1D
     | Fri Mar 01 01:32:01 1996 CST | Tue Dec 31 01:32:01 1996 CST | P-305D
     | Fri Mar 01 01:32:01 1996 CST | Wed Jan 01 01:32:01 1997 CST | P-306D
     | Fri Mar 01 01:32:01 1996 CST | Sat Jan 01 01:32:01 2000 CST | P-1401D
     | Fri Mar 01 01:32:01 1996 CST | Sun Jan 02 01:32:01 2000 CST | P-1402D
     | Fri Mar 01 01:32:01 1996 CST | Wed Mar 15 10:14:05 2000 CST | P-1475DT-8H-42M-4S
     | Fri Mar 01 01:32:01 1996 CST | Wed Mar 15 11:14:04 2000 CST | P-1475DT-9H-42M-3S
     | Fri Mar 01 01:32:01 1996 CST | Wed Mar 15 16:14:01 2000 CST | P-1475DT-14H-42M
     | Fri Mar 01 01:32:01 1996 CST | Wed Mar 15 20:14:03 2000 CST | P-1475DT-18H-42M-2S
     | Fri Mar 01 01:32:01 1996 CST | Wed Mar 15 21:14:02 2000 CST | P-1475DT-19H-42M-1S
     | Fri Mar 01 01:32:01 1996 CST | Mon Jan 01 01:32:01 2001 CST | P-1767D
     | Fri Mar 01 01:32:01 1996 CST | Tue Jan 02 01:32:01 2001 CST | P-1768D
     | Fri Mar 01 01:32:01 1996 CST | Sun Sep 23 02:19:20 2001 CST | P-2032DT-47M-19S
     | Sat Mar 02 01:32:01 1996 CST | Thu Jan 01 08:00:00 1970 CST | P9556DT17H32M1S
     | Sat Mar 02 01:32:01 1996 CST | Thu Feb 29 01:32:01 1996 CST | P2D
     | Sat Mar 02 01:32:01 1996 CST | Fri Mar 01 01:32:01 1996 CST | P1D
     | Sat Mar 02 01:32:01 1996 CST | Sat Mar 02 01:32:01 1996 CST | PT0S
     | Sat Mar 02 01:32:01 1996 CST | Tue Dec 31 01:32:01 1996 CST | P-304D
     | Sat Mar 02 01:32:01 1996 CST | Wed Jan 01 01:32:01 1997 CST | P-305D
     | Sat Mar 02 01:32:01 1996 CST | Sat Jan 01 01:32:01 2000 CST | P-1400D
     | Sat Mar 02 01:32:01 1996 CST | Sun Jan 02 01:32:01 2000 CST | P-1401D
     | Sat Mar 02 01:32:01 1996 CST | Wed Mar 15 10:14:05 2000 CST | P-1474DT-8H-42M-4S
     | Sat Mar 02 01:32:01 1996 CST | Wed Mar 15 11:14:04 2000 CST | P-1474DT-9H-42M-3S
     | Sat Mar 02 01:32:01 1996 CST | Wed Mar 15 16:14:01 2000 CST | P-1474DT-14H-42M
     | Sat Mar 02 01:32:01 1996 CST | Wed Mar 15 20:14:03 2000 CST | P-1474DT-18H-42M-2S
     | Sat Mar 02 01:32:01 1996 CST | Wed Mar 15 21:14:02 2000 CST | P-1474DT-19H-42M-1S
     | Sat Mar 02 01:32:01 1996 CST | Mon Jan 01 01:32:01 2001 CST | P-1766D
     | Sat Mar 02 01:32:01 1996 CST | Tue Jan 02 01:32:01 2001 CST | P-1767D
     | Sat Mar 02 01:32:01 1996 CST | Sun Sep 23 02:19:20 2001 CST | P-2031DT-47M-19S
     | Tue Dec 31 01:32:01 1996 CST | Thu Jan 01 08:00:00 1970 CST | P9860DT17H32M1S
     | Tue Dec 31 01:32:01 1996 CST | Thu Feb 29 01:32:01 1996 CST | P306D
     | Tue Dec 31 01:32:01 1996 CST | Fri Mar 01 01:32:01 1996 CST | P305D
     | Tue Dec 31 01:32:01 1996 CST | Sat Mar 02 01:32:01 1996 CST | P304D
     | Tue Dec 31 01:32:01 1996 CST | Tue Dec 31 01:32:01 1996 CST | PT0S
     | Tue Dec 31 01:32:01 1996 CST | Wed Jan 01 01:32:01 1997 CST | P-1D
     | Tue Dec 31 01:32:01 1996 CST | Sat Jan 01 01:32:01 2000 CST | P-1096D
     | Tue Dec 31 01:32:01 1996 CST | Sun Jan 02 01:32:01 2000 CST | P-1097D
     | Tue Dec 31 01:32:01 1996 CST | Wed Mar 15 10:14:05 2000 CST | P-1170DT-8H-42M-4S
     | Tue Dec 31 01:32:01 1996 CST | Wed Mar 15 11:14:04 2000 CST | P-1170DT-9H-42M-3S
     | Tue Dec 31 01:32:01 1996 CST | Wed Mar 15 16:14:01 2000 CST | P-1170DT-14H-42M
     | Tue Dec 31 01:32:01 1996 CST | Wed Mar 15 20:14:03 2000 CST | P-1170DT-18H-42M-2S
     | Tue Dec 31 01:32:01 1996 CST | Wed Mar 15 21:14:02 2000 CST | P-1170DT-19H-42M-1S
     | Tue Dec 31 01:32:01 1996 CST | Mon Jan 01 01:32:01 2001 CST | P-1462D
     | Tue Dec 31 01:32:01 1996 CST | Tue Jan 02 01:32:01 2001 CST | P-1463D
     | Tue Dec 31 01:32:01 1996 CST | Sun Sep 23 02:19:20 2001 CST | P-1727DT-47M-19S
     | Wed Jan 01 01:32:01 1997 CST | Thu Jan 01 08:00:00 1970 CST | P9861DT17H32M1S
     | Wed Jan 01 01:32:01 1997 CST | Thu Feb 29 01:32:01 1996 CST | P307D
     | Wed Jan 01 01:32:01 1997 CST | Fri Mar 01 01:32:01 1996 CST | P306D
     | Wed Jan 01 01:32:01 1997 CST | Sat Mar 02 01:32:01 1996 CST | P305D
     | Wed Jan 01 01:32:01 1997 CST | Tue Dec 31 01:32:01 1996 CST | P1D
     | Wed Jan 01 01:32:01 1997 CST | Wed Jan 01 01:32:01 1997 CST | PT0S
     | Wed Jan 01 01:32:01 1997 CST | Sat Jan 01 01:32:01 2000 CST | P-1095D
     | Wed Jan 01 01:32:01 1997 CST | Sun Jan 02 01:32:01 2000 CST | P-1096D
     | Wed Jan 01 01:32:01 1997 CST | Wed Mar 15 10:14:05 2000 CST | P-1169DT-8H-42M-4S
     | Wed Jan 01 01:32:01 1997 CST | Wed Mar 15 11:14:04 2000 CST | P-1169DT-9H-42M-3S
     | Wed Jan 01 01:32:01 1997 CST | Wed Mar 15 16:14:01 2000 CST | P-1169DT-14H-42M
     | Wed Jan 01 01:32:01 1997 CST | Wed Mar 15 20:14:03 2000 CST | P-1169DT-18H-42M-2S
     | Wed Jan 01 01:32:01 1997 CST | Wed Mar 15 21:14:02 2000 CST | P-1169DT-19H-42M-1S
     | Wed Jan 01 01:32:01 1997 CST | Mon Jan 01 01:32:01 2001 CST | P-1461D
     | Wed Jan 01 01:32:01 1997 CST | Tue Jan 02 01:32:01 2001 CST | P-1462D
     | Wed Jan 01 01:32:01 1997 CST | Sun Sep 23 02:19:20 2001 CST | P-1726DT-47M-19S
     | Sat Jan 01 01:32:01 2000 CST | Thu Jan 01 08:00:00 1970 CST | P10956DT17H32M1S
     | Sat Jan 01 01:32:01 2000 CST | Thu Feb 29 01:32:01 1996 CST | P1402D
     | Sat Jan 01 01:32:01 2000 CST | Fri Mar 01 01:32:01 1996 CST | P1401D
     | Sat Jan 01 01:32:01 2000 CST | Sat Mar 02 01:32:01 1996 CST | P1400D
     | Sat Jan 01 01:32:01 2000 CST | Tue Dec 31 01:32:01 1996 CST | P1096D
     | Sat Jan 01 01:32:01 2000 CST | Wed Jan 01 01:32:01 1997 CST | P1095D
     | Sat Jan 01 01:32:01 2000 CST | Sat Jan 01 01:32:01 2000 CST | PT0S
     | Sat Jan 01 01:32:01 2000 CST | Sun Jan 02 01:32:01 2000 CST | P-1D
     | Sat Jan 01 01:32:01 2000 CST | Wed Mar 15 10:14:05 2000 CST | P-74DT-8H-42M-4S
     | Sat Jan 01 01:32:01 2000 CST | Wed Mar 15 11:14:04 2000 CST | P-74DT-9H-42M-3S
     | Sat Jan 01 01:32:01 2000 CST | Wed Mar 15 16:14:01 2000 CST | P-74DT-14H-42M
     | Sat Jan 01 01:32:01 2000 CST | Wed Mar 15 20:14:03 2000 CST | P-74DT-18H-42M-2S
     | Sat Jan 01 01:32:01 2000 CST | Wed Mar 15 21:14:02 2000 CST | P-74DT-19H-42M-1S
     | Sat Jan 01 01:32:01 2000 CST | Mon Jan 01 01:32:01 2001 CST | P-366D
     | Sat Jan 01 01:32:01 2000 CST | Tue Jan 02 01:32:01 2001 CST | P-367D
     | Sat Jan 01 01:32:01 2000 CST | Sun Sep 23 02:19:20 2001 CST | P-631DT-47M-19S
     | Sun Jan 02 01:32:01 2000 CST | Thu Jan 01 08:00:00 1970 CST | P10957DT17H32M1S
     | Sun Jan 02 01:32:01 2000 CST | Thu Feb 29 01:32:01 1996 CST | P1403D
     | Sun Jan 02 01:32:01 2000 CST | Fri Mar 01 01:32:01 1996 CST | P1402D
     | Sun Jan 02 01:32:01 2000 CST | Sat Mar 02 01:32:01 1996 CST | P1401D
     | Sun Jan 02 01:32:01 2000 CST | Tue Dec 31 01:32:01 1996 CST | P1097D
     | Sun Jan 02 01:32:01 2000 CST | Wed Jan 01 01:32:01 1997 CST | P1096D
     | Sun Jan 02 01:32:01 2000 CST | Sat Jan 01 01:32:01 2000 CST | P1D
     | Sun Jan 02 01:32:01 2000 CST | Sun Jan 02 01:32:01 2000 CST | PT0S
     | Sun Jan 02 01:32:01 2000 CST | Wed Mar 15 10:14:05 2000 CST | P-73DT-8H-42M-4S
     | Sun Jan 02 01:32:01 2000 CST | Wed Mar 15 11:14:04 2000 CST | P-73DT-9H-42M-3S
     | Sun Jan 02 01:32:01 2000 CST | Wed Mar 15 16:14:01 2000 CST | P-73DT-14H-42M
     | Sun Jan 02 01:32:01 2000 CST | Wed Mar 15 20:14:03 2000 CST | P-73DT-18H-42M-2S
     | Sun Jan 02 01:32:01 2000 CST | Wed Mar 15 21:14:02 2000 CST | P-73DT-19H-42M-1S
     | Sun Jan 02 01:32:01 2000 CST | Mon Jan 01 01:32:01 2001 CST | P-365D
     | Sun Jan 02 01:32:01 2000 CST | Tue Jan 02 01:32:01 2001 CST | P-366D
     | Sun Jan 02 01:32:01 2000 CST | Sun Sep 23 02:19:20 2001 CST | P-630DT-47M-19S
     | Wed Mar 15 10:14:05 2000 CST | Thu Jan 01 08:00:00 1970 CST | P11031DT2H14M5S
     | Wed Mar 15 10:14:05 2000 CST | Thu Feb 29 01:32:01 1996 CST | P1476DT8H42M4S
     | Wed Mar 15 10:14:05 2000 CST | Fri Mar 01 01:32:01 1996 CST | P1475DT8H42M4S
     | Wed Mar 15 10:14:05 2000 CST | Sat Mar 02 01:32:01 1996 CST | P1474DT8H42M4S
     | Wed Mar 15 10:14:05 2000 CST | Tue Dec 31 01:32:01 1996 CST | P1170DT8H42M4S
     | Wed Mar 15 10:14:05 2000 CST | Wed Jan 01 01:32:01 1997 CST | P1169DT8H42M4S
     | Wed Mar 15 10:14:05 2000 CST | Sat Jan 01 01:32:01 2000 CST | P74DT8H42M4S
     | Wed Mar 15 10:14:05 2000 CST | Sun Jan 02 01:32:01 2000 CST | P73DT8H42M4S
     | Wed Mar 15 10:14:05 2000 CST | Wed Mar 15 10:14:05 2000 CST | PT0S
     | Wed Mar 15 10:14:05 2000 CST | Wed Mar 15 11:14:04 2000 CST | PT-59M-59S
     | Wed Mar 15 10:14:05 2000 CST | Wed Mar 15 16:14:01 2000 CST | PT-5H-59M-56S
     | Wed Mar 15 10:14:05 2000 CST | Wed Mar 15 20:14:03 2000 CST | PT-9H-59M-58S
     | Wed Mar 15 10:14:05 2000 CST | Wed Mar 15 21:14:02 2000 CST | PT-10H-59M-57S
     | Wed Mar 15 10:14:05 2000 CST | Mon Jan 01 01:32:01 2001 CST | P-291DT-15H-17M-56S
     | Wed Mar 15 10:14:05 2000 CST | Tue Jan 02 01:32:01 2001 CST | P-292DT-15H-17M-56S
     | Wed Mar 15 10:14:05 2000 CST | Sun Sep 23 02:19:20 2001 CST | P-556DT-16H-5M-15S
     | Wed Mar 15 11:14:04 2000 CST | Thu Jan 01 08:00:00 1970 CST | P11031DT3H14M4S
     | Wed Mar 15 11:14:04 2000 CST | Thu Feb 29 01:32:01 1996 CST | P1476DT9H42M3S
     | Wed Mar 15 11:14:04 2000 CST | Fri Mar 01 01:32:01 1996 CST | P1475DT9H42M3S
     | Wed Mar 15 11:14:04 2000 CST | Sat Mar 02 01:32:01 1996 CST | P1474DT9H42M3S
     | Wed Mar 15 11:14:04 2000 CST | Tue Dec 31 01:32:01 1996 CST | P1170DT9H42M3S
     | Wed Mar 15 11:14:04 2000 CST | Wed Jan 01 01:32:01 1997 CST | P1169DT9H42M3S
     | Wed Mar 15 11:14:04 2000 CST | Sat Jan 01 01:32:01 2000 CST | P74DT9H42M3S
     | Wed Mar 15 11:14:04 2000 CST | Sun Jan 02 01:32:01 2000 CST | P73DT9H42M3S
     | Wed Mar 15 11:14:04 2000 CST | Wed Mar 15 10:14:05 2000 CST | PT59M59S
     | Wed Mar 15 11:14:04 2000 CST | Wed Mar 15 11:14:04 2000 CST | PT0S
     | Wed Mar 15 11:14:04 2000 CST | Wed Mar 15 16:14:01 2000 CST | PT-4H-59M-57S
     | Wed Mar 15 11:14:04 2000 CST | Wed Mar 15 20:14:03 2000 CST | PT-8H-59M-59S
     | Wed Mar 15 11:14:04 2000 CST | Wed Mar 15 21:14:02 2000 CST | PT-9H-59M-58S
     | Wed Mar 15 11:14:04 2000 CST | Mon Jan 01 01:32:01 2001 CST | P-291DT-14H-17M-57S
     | Wed Mar 15 11:14:04 2000 CST | Tue Jan 02 01:32:01 2001 CST | P-292DT-14H-17M-57S
     | Wed Mar 15 11:14:04 2000 CST | Sun Sep 23 02:19:20 2001 CST | P-556DT-15H-5M-16S
     | Wed Mar 15 16:14:01 2000 CST | Thu Jan 01 08:00:00 1970 CST | P11031DT8H14M1S
     | Wed Mar 15 16:14:01 2000 CST | Thu Feb 29 01:32:01 1996 CST | P1476DT14H42M
     | Wed Mar 15 16:14:01 2000 CST | Fri Mar 01 01:32:01 1996 CST | P1475DT14H42M
     | Wed Mar 15 16:14:01 2000 CST | Sat Mar 02 01:32:01 1996 CST | P1474DT14H42M
     | Wed Mar 15 16:14:01 2000 CST | Tue Dec 31 01:32:01 1996 CST | P1170DT14H42M
     | Wed Mar 15 16:14:01 2000 CST | Wed Jan 01 01:32:01 1997 CST | P1169DT14H42M
     | Wed Mar 15 16:14:01 2000 CST | Sat Jan 01 01:32:01 2000 CST | P74DT14H42M
     | Wed Mar 15 16:14:01 2000 CST | Sun Jan 02 01:32:01 2000 CST | P73DT14H42M
     | Wed Mar 15 16:14:01 2000 CST | Wed Mar 15 10:14:05 2000 CST | PT5H59M56S
     | Wed Mar 15 16:14:01 2000 CST | Wed Mar 15 11:14:04 2000 CST | PT4H59M57S
     | Wed Mar 15 16:14:01 2000 CST | Wed Mar 15 16:14:01 2000 CST | PT0S
     | Wed Mar 15 16:14:01 2000 CST | Wed Mar 15 20:14:03 2000 CST | PT-4H-2S
     | Wed Mar 15 16:14:01 2000 CST | Wed Mar 15 21:14:02 2000 CST | PT-5H-1S
     | Wed Mar 15 16:14:01 2000 CST | Mon Jan 01 01:32:01 2001 CST | P-291DT-9H-18M
     | Wed Mar 15 16:14:01 2000 CST | Tue Jan 02 01:32:01 2001 CST | P-292DT-9H-18M
     | Wed Mar 15 16:14:01 2000 CST | Sun Sep 23 02:19:20 2001 CST | P-556DT-10H-5M-19S
     | Wed Mar 15 20:14:03 2000 CST | Thu Jan 01 08:00:00 1970 CST | P11031DT12H14M3S
     | Wed Mar 15 20:14:03 2000 CST | Thu Feb 29 01:32:01 1996 CST | P1476DT18H42M2S
     | Wed Mar 15 20:14:03 2000 CST | Fri Mar 01 01:32:01 1996 CST | P1475DT18H42M2S
     | Wed Mar 15 20:14:03 2000 CST | Sat Mar 02 01:32:01 1996 CST | P1474DT18H42M2S
     | Wed Mar 15 20:14:03 2000 CST | Tue Dec 31 01:32:01 1996 CST | P1170DT18H42M2S
     | Wed Mar 15 20:14:03 2000 CST | Wed Jan 01 01:32:01 1997 CST | P1169DT18H42M2S
     | Wed Mar 15 20:14:03 2000 CST | Sat Jan 01 01:32:01 2000 CST | P74DT18H42M2S
     | Wed Mar 15 20:14:03 2000 CST | Sun Jan 02 01:32:01 2000 CST | P73DT18H42M2S
     | Wed Mar 15 20:14:03 2000 CST | Wed Mar 15 10:14:05 2000 CST | PT9H59M58S
     | Wed Mar 15 20:14:03 2000 CST | Wed Mar 15 11:14:04 2000 CST | PT8H59M59S
     | Wed Mar 15 20:14:03 2000 CST | Wed Mar 15 16:14:01 2000 CST | PT4H2S
     | Wed Mar 15 20:14:03 2000 CST | Wed Mar 15 20:14:03 2000 CST | PT0S
     | Wed Mar 15 20:14:03 2000 CST | Wed Mar 15 21:14:02 2000 CST | PT-59M-59S
     | Wed Mar 15 20:14:03 2000 CST | Mon Jan 01 01:32:01 2001 CST | P-291DT-5H-17M-58S
     | Wed Mar 15 20:14:03 2000 CST | Tue Jan 02 01:32:01 2001 CST | P-292DT-5H-17M-58S
     | Wed Mar 15 20:14:03 2000 CST | Sun Sep 23 02:19:20 2001 CST | P-556DT-6H-5M-17S
     | Wed Mar 15 21:14:02 2000 CST | Thu Jan 01 08:00:00 1970 CST | P11031DT13H14M2S
     | Wed Mar 15 21:14:02 2000 CST | Thu Feb 29 01:32:01 1996 CST | P1476DT19H42M1S
     | Wed Mar 15 21:14:02 2000 CST | Fri Mar 01 01:32:01 1996 CST | P1475DT19H42M1S
     | Wed Mar 15 21:14:02 2000 CST | Sat Mar 02 01:32:01 1996 CST | P1474DT19H42M1S
     | Wed Mar 15 21:14:02 2000 CST | Tue Dec 31 01:32:01 1996 CST | P1170DT19H42M1S
     | Wed Mar 15 21:14:02 2000 CST | Wed Jan 01 01:32:01 1997 CST | P1169DT19H42M1S
     | Wed Mar 15 21:14:02 2000 CST | Sat Jan 01 01:32:01 2000 CST | P74DT19H42M1S
     | Wed Mar 15 21:14:02 2000 CST | Sun Jan 02 01:32:01 2000 CST | P73DT19H42M1S
     | Wed Mar 15 21:14:02 2000 CST | Wed Mar 15 10:14:05 2000 CST | PT10H59M57S
     | Wed Mar 15 21:14:02 2000 CST | Wed Mar 15 11:14:04 2000 CST | PT9H59M58S
     | Wed Mar 15 21:14:02 2000 CST | Wed Mar 15 16:14:01 2000 CST | PT5H1S
     | Wed Mar 15 21:14:02 2000 CST | Wed Mar 15 20:14:03 2000 CST | PT59M59S
     | Wed Mar 15 21:14:02 2000 CST | Wed Mar 15 21:14:02 2000 CST | PT0S
     | Wed Mar 15 21:14:02 2000 CST | Mon Jan 01 01:32:01 2001 CST | P-291DT-4H-17M-59S
     | Wed Mar 15 21:14:02 2000 CST | Tue Jan 02 01:32:01 2001 CST | P-292DT-4H-17M-59S
     | Wed Mar 15 21:14:02 2000 CST | Sun Sep 23 02:19:20 2001 CST | P-556DT-5H-5M-18S
     | Mon Jan 01 01:32:01 2001 CST | Thu Jan 01 08:00:00 1970 CST | P11322DT17H32M1S
     | Mon Jan 01 01:32:01 2001 CST | Thu Feb 29 01:32:01 1996 CST | P1768D
     | Mon Jan 01 01:32:01 2001 CST | Fri Mar 01 01:32:01 1996 CST | P1767D
     | Mon Jan 01 01:32:01 2001 CST | Sat Mar 02 01:32:01 1996 CST | P1766D
     | Mon Jan 01 01:32:01 2001 CST | Tue Dec 31 01:32:01 1996 CST | P1462D
     | Mon Jan 01 01:32:01 2001 CST | Wed Jan 01 01:32:01 1997 CST | P1461D
     | Mon Jan 01 01:32:01 2001 CST | Sat Jan 01 01:32:01 2000 CST | P366D
     | Mon Jan 01 01:32:01 2001 CST | Sun Jan 02 01:32:01 2000 CST | P365D
     | Mon Jan 01 01:32:01 2001 CST | Wed Mar 15 10:14:05 2000 CST | P291DT15H17M56S
     | Mon Jan 01 01:32:01 2001 CST | Wed Mar 15 11:14:04 2000 CST | P291DT14H17M57S
     | Mon Jan 01 01:32:01 2001 CST | Wed Mar 15 16:14:01 2000 CST | P291DT9H18M
     | Mon Jan 01 01:32:01 2001 CST | Wed Mar 15 20:14:03 2000 CST | P291DT5H17M58S
     | Mon Jan 01 01:32:01 2001 CST | Wed Mar 15 21:14:02 2000 CST | P291DT4H17M59S
     | Mon Jan 01 01:32:01 2001 CST | Mon Jan 01 01:32:01 2001 CST | PT0S
     | Mon Jan 01 01:32:01 2001 CST | Tue Jan 02 01:32:01 2001 CST | P-1D
     | Mon Jan 01 01:32:01 2001 CST | Sun Sep 23 02:19:20 2001 CST | P-265DT-47M-19S
     | Tue Jan 02 01:32:01 2001 CST | Thu Jan 01 08:00:00 1970 CST | P11323DT17H32M1S
     | Tue Jan 02 01:32:01 2001 CST | Thu Feb 29 01:32:01 1996 CST | P1769D
     | Tue Jan 02 01:32:01 2001 CST | Fri Mar 01 01:32:01 1996 CST | P1768D
     | Tue Jan 02 01:32:01 2001 CST | Sat Mar 02 01:32:01 1996 CST | P1767D
     | Tue Jan 02 01:32:01 2001 CST | Tue Dec 31 01:32:01 1996 CST | P1463D
     | Tue Jan 02 01:32:01 2001 CST | Wed Jan 01 01:32:01 1997 CST | P1462D
     | Tue Jan 02 01:32:01 2001 CST | Sat Jan 01 01:32:01 2000 CST | P367D
     | Tue Jan 02 01:32:01 2001 CST | Sun Jan 02 01:32:01 2000 CST | P366D
     | Tue Jan 02 01:32:01 2001 CST | Wed Mar 15 10:14:05 2000 CST | P292DT15H17M56S
     | Tue Jan 02 01:32:01 2001 CST | Wed Mar 15 11:14:04 2000 CST | P292DT14H17M57S
     | Tue Jan 02 01:32:01 2001 CST | Wed Mar 15 16:14:01 2000 CST | P292DT9H18M
     | Tue Jan 02 01:32:01 2001 CST | Wed Mar 15 20:14:03 2000 CST | P292DT5H17M58S
     | Tue Jan 02 01:32:01 2001 CST | Wed Mar 15 21:14:02 2000 CST | P292DT4H17M59S
     | Tue Jan 02 01:32:01 2001 CST | Mon Jan 01 01:32:01 2001 CST | P1D
     | Tue Jan 02 01:32:01 2001 CST | Tue Jan 02 01:32:01 2001 CST | PT0S
     | Tue Jan 02 01:32:01 2001 CST | Sun Sep 23 02:19:20 2001 CST | P-264DT-47M-19S
     | Sun Sep 23 02:19:20 2001 CST | Thu Jan 01 08:00:00 1970 CST | P11587DT18H19M20S
     | Sun Sep 23 02:19:20 2001 CST | Thu Feb 29 01:32:01 1996 CST | P2033DT47M19S
     | Sun Sep 23 02:19:20 2001 CST | Fri Mar 01 01:32:01 1996 CST | P2032DT47M19S
     | Sun Sep 23 02:19:20 2001 CST | Sat Mar 02 01:32:01 1996 CST | P2031DT47M19S
     | Sun Sep 23 02:19:20 2001 CST | Tue Dec 31 01:32:01 1996 CST | P1727DT47M19S
     | Sun Sep 23 02:19:20 2001 CST | Wed Jan 01 01:32:01 1997 CST | P1726DT47M19S
     | Sun Sep 23 02:19:20 2001 CST | Sat Jan 01 01:32:01 2000 CST | P631DT47M19S
     | Sun Sep 23 02:19:20 2001 CST | Sun Jan 02 01:32:01 2000 CST | P630DT47M19S
     | Sun Sep 23 02:19:20 2001 CST | Wed Mar 15 10:14:05 2000 CST | P556DT16H5M15S
     | Sun Sep 23 02:19:20 2001 CST | Wed Mar 15 11:14:04 2000 CST | P556DT15H5M16S
     | Sun Sep 23 02:19:20 2001 CST | Wed Mar 15 16:14:01 2000 CST | P556DT10H5M19S
     | Sun Sep 23 02:19:20 2001 CST | Wed Mar 15 20:14:03 2000 CST | P556DT6H5M17S
     | Sun Sep 23 02:19:20 2001 CST | Wed Mar 15 21:14:02 2000 CST | P556DT5H5M18S
     | Sun Sep 23 02:19:20 2001 CST | Mon Jan 01 01:32:01 2001 CST | P265DT47M19S
     | Sun Sep 23 02:19:20 2001 CST | Tue Jan 02 01:32:01 2001 CST | P264DT47M19S
     | Sun Sep 23 02:19:20 2001 CST | Sun Sep 23 02:19:20 2001 CST | PT0S
(256 rows)

--
-- Conversions
--
SELECT '' AS "16", f1 AS "timestamp", date(f1) AS date
  FROM TEMP_TIMESTAMP
  WHERE f1 <> timestamp 'now'
  ORDER BY date, "timestamp";
 16 |          timestamp           |    date    
----+------------------------------+------------
    | Thu Jan 01 08:00:00 1970 CST | 01-01-1970
    | Thu Feb 29 01:32:01 1996 CST | 02-28-1996
    | Fri Mar 01 01:32:01 1996 CST | 02-29-1996
    | Sat Mar 02 01:32:01 1996 CST | 03-01-1996
    | Tue Dec 31 01:32:01 1996 CST | 12-30-1996
    | Wed Jan 01 01:32:01 1997 CST | 12-31-1996
    | Sat Jan 01 01:32:01 2000 CST | 12-31-1999
    | Sun Jan 02 01:32:01 2000 CST | 01-01-2000
    | Wed Mar 15 10:14:05 2000 CST | 03-15-2000
    | Wed Mar 15 11:14:04 2000 CST | 03-15-2000
    | Wed Mar 15 16:14:01 2000 CST | 03-15-2000
    | Wed Mar 15 20:14:03 2000 CST | 03-15-2000
    | Wed Mar 15 21:14:02 2000 CST | 03-15-2000
    | Mon Jan 01 01:32:01 2001 CST | 12-31-2000
    | Tue Jan 02 01:32:01 2001 CST | 01-01-2001
    | Sun Sep 23 02:19:20 2001 CST | 09-22-2001
(16 rows)

  
DROP TABLE TEMP_TIMESTAMP;
DROP TABLE
--
-- Formats
--
SET DateStyle TO 'US,Postgres';
SET
SHOW DateStyle;
   DateStyle   
---------------
 Postgres, MDY
(1 row)

SELECT '' AS "64", d1 AS us_postgres FROM TIMESTAMP_TBL;
 64 |        us_postgres         
----+----------------------------
    | Thu Jan 01 00:00:00 1970
    | Mon Feb 10 17:32:01 1997
    | Mon Feb 10 17:32:01 1997
    | Mon Feb 10 17:32:02 1997
    | Mon Feb 10 17:32:01.4 1997
    | Mon Feb 10 17:32:01.5 1997
    | Mon Feb 10 17:32:01.6 1997
    | Thu Jan 02 00:00:00 1997
    | Thu Jan 02 03:04:05 1997
    | Mon Feb 10 17:32:01 1997
    | Mon Feb 10 17:32:01 1997
    | Mon Feb 10 17:32:01 1997
    | Mon Feb 10 17:32:01 1997
    | Tue Jun 10 17:32:01 1997
    | Sat Sep 22 18:19:20 2001
    | Wed Mar 15 08:14:01 2000
    | Wed Mar 15 13:14:02 2000
    | Wed Mar 15 12:14:03 2000
    | Wed Mar 15 03:14:04 2000
    | Wed Mar 15 02:14:05 2000
    | Mon Feb 10 17:32:01 1997
    | Mon Feb 10 17:32:01 1997
    | Mon Feb 10 17:32:00 1997
    | Mon Feb 10 17:32:01 1997
    | Mon Feb 10 17:32:01 1997
    | Mon Feb 10 17:32:01 1997
    | Mon Feb 10 17:32:01 1997
    | Mon Feb 10 17:32:01 1997
    | Mon Feb 10 17:32:01 1997
    | Mon Feb 10 17:32:01 1997
    | Mon Feb 10 17:32:01 1997
    | Tue Jun 10 18:32:01 1997
    | Mon Feb 10 17:32:01 1997
    | Tue Feb 11 17:32:01 1997
    | Wed Feb 12 17:32:01 1997
    | Thu Feb 13 17:32:01 1997
    | Fri Feb 14 17:32:01 1997
    | Sat Feb 15 17:32:01 1997
    | Sun Feb 16 17:32:01 1997
    | Sat Feb 16 17:32:01 0097
    | Thu Feb 16 17:32:01 0597
    | Tue Feb 16 17:32:01 1097
    | Sat Feb 16 17:32:01 1697
    | Thu Feb 16 17:32:01 1797
    | Tue Feb 16 17:32:01 1897
    | Sun Feb 16 17:32:01 1997
    | Sat Feb 16 17:32:01 2097
    | Wed Feb 28 17:32:01 1996
    | Thu Feb 29 17:32:01 1996
    | Fri Mar 01 17:32:01 1996
    | Mon Dec 30 17:32:01 1996
    | Tue Dec 31 17:32:01 1996
    | Wed Jan 01 17:32:01 1997
    | Fri Feb 28 17:32:01 1997
    | Sat Mar 01 17:32:01 1997
    | Tue Dec 30 17:32:01 1997
    | Wed Dec 31 17:32:01 1997
    | Fri Dec 31 17:32:01 1999
    | Sat Jan 01 17:32:01 2000
    | Sun Dec 31 17:32:01 2000
    | Mon Jan 01 17:32:01 2001
(61 rows)

SET DateStyle TO 'US,ISO';
SET
SELECT '' AS "64", d1 AS us_iso FROM TIMESTAMP_TBL;
 64 |        us_iso         
----+-----------------------
    | 1970-01-01 00:00:00
    | 1997-02-10 17:32:01
    | 1997-02-10 17:32:01
    | 1997-02-10 17:32:02
    | 1997-02-10 17:32:01.4
    | 1997-02-10 17:32:01.5
    | 1997-02-10 17:32:01.6
    | 1997-01-02 00:00:00
    | 1997-01-02 03:04:05
    | 1997-02-10 17:32:01
    | 1997-02-10 17:32:01
    | 1997-02-10 17:32:01
    | 1997-02-10 17:32:01
    | 1997-06-10 17:32:01
    | 2001-09-22 18:19:20
    | 2000-03-15 08:14:01
    | 2000-03-15 13:14:02
    | 2000-03-15 12:14:03
    | 2000-03-15 03:14:04
    | 2000-03-15 02:14:05
    | 1997-02-10 17:32:01
    | 1997-02-10 17:32:01
    | 1997-02-10 17:32:00
    | 1997-02-10 17:32:01
    | 1997-02-10 17:32:01
    | 1997-02-10 17:32:01
    | 1997-02-10 17:32:01
    | 1997-02-10 17:32:01
    | 1997-02-10 17:32:01
    | 1997-02-10 17:32:01
    | 1997-02-10 17:32:01
    | 1997-06-10 18:32:01
    | 1997-02-10 17:32:01
    | 1997-02-11 17:32:01
    | 1997-02-12 17:32:01
    | 1997-02-13 17:32:01
    | 1997-02-14 17:32:01
    | 1997-02-15 17:32:01
    | 1997-02-16 17:32:01
    | 0097-02-16 17:32:01
    | 0597-02-16 17:32:01
    | 1097-02-16 17:32:01
    | 1697-02-16 17:32:01
    | 1797-02-16 17:32:01
    | 1897-02-16 17:32:01
    | 1997-02-16 17:32:01
    | 2097-02-16 17:32:01
    | 1996-02-28 17:32:01
    | 1996-02-29 17:32:01
    | 1996-03-01 17:32:01
    | 1996-12-30 17:32:01
    | 1996-12-31 17:32:01
    | 1997-01-01 17:32:01
    | 1997-02-28 17:32:01
    | 1997-03-01 17:32:01
    | 1997-12-30 17:32:01
    | 1997-12-31 17:32:01
    | 1999-12-31 17:32:01
    | 2000-01-01 17:32:01
    | 2000-12-31 17:32:01
    | 2001-01-01 17:32:01
(61 rows)

SET DateStyle TO 'US,SQL';
SET
SHOW DateStyle;
 DateStyle 
-----------
 SQL, MDY
(1 row)

SELECT '' AS "64", d1 AS us_sql FROM TIMESTAMP_TBL;
 64 |        us_sql         
----+-----------------------
    | 01/01/1970 00:00:00
    | 02/10/1997 17:32:01
    | 02/10/1997 17:32:01
    | 02/10/1997 17:32:02
    | 02/10/1997 17:32:01.4
    | 02/10/1997 17:32:01.5
    | 02/10/1997 17:32:01.6
    | 01/02/1997 00:00:00
    | 01/02/1997 03:04:05
    | 02/10/1997 17:32:01
    | 02/10/1997 17:32:01
    | 02/10/1997 17:32:01
    | 02/10/1997 17:32:01
    | 06/10/1997 17:32:01
    | 09/22/2001 18:19:20
    | 03/15/2000 08:14:01
    | 03/15/2000 13:14:02
    | 03/15/2000 12:14:03
    | 03/15/2000 03:14:04
    | 03/15/2000 02:14:05
    | 02/10/1997 17:32:01
    | 02/10/1997 17:32:01
    | 02/10/1997 17:32:00
    | 02/10/1997 17:32:01
    | 02/10/1997 17:32:01
    | 02/10/1997 17:32:01
    | 02/10/1997 17:32:01
    | 02/10/1997 17:32:01
    | 02/10/1997 17:32:01
    | 02/10/1997 17:32:01
    | 02/10/1997 17:32:01
    | 06/10/1997 18:32:01
    | 02/10/1997 17:32:01
    | 02/11/1997 17:32:01
    | 02/12/1997 17:32:01
    | 02/13/1997 17:32:01
    | 02/14/1997 17:32:01
    | 02/15/1997 17:32:01
    | 02/16/1997 17:32:01
    | 02/16/0097 17:32:01
    | 02/16/0597 17:32:01
    | 02/16/1097 17:32:01
    | 02/16/1697 17:32:01
    | 02/16/1797 17:32:01
    | 02/16/1897 17:32:01
    | 02/16/1997 17:32:01
    | 02/16/2097 17:32:01
    | 02/28/1996 17:32:01
    | 02/29/1996 17:32:01
    | 03/01/1996 17:32:01
    | 12/30/1996 17:32:01
    | 12/31/1996 17:32:01
    | 01/01/1997 17:32:01
    | 02/28/1997 17:32:01
    | 03/01/1997 17:32:01
    | 12/30/1997 17:32:01
    | 12/31/1997 17:32:01
    | 12/31/1999 17:32:01
    | 01/01/2000 17:32:01
    | 12/31/2000 17:32:01
    | 01/01/2001 17:32:01
(61 rows)

SET DateStyle TO 'European,Postgres';
SET
SHOW DateStyle;
   DateStyle   
---------------
 Postgres, DMY
(1 row)

INSERT INTO TIMESTAMP_TBL VALUES('13/06/1957');
INSERT 0 1
SELECT count(*) as one FROM TIMESTAMP_TBL WHERE d1 = 'Jun 13 1957';
 one 
-----
   1
(1 row)

SELECT '' AS "65", d1 AS european_postgres FROM TIMESTAMP_TBL;
 65 |     european_postgres      
----+----------------------------
    | Thu 01 Jan 00:00:00 1970
    | Mon 10 Feb 17:32:01 1997
    | Mon 10 Feb 17:32:01 1997
    | Mon 10 Feb 17:32:02 1997
    | Mon 10 Feb 17:32:01.4 1997
    | Mon 10 Feb 17:32:01.5 1997
    | Mon 10 Feb 17:32:01.6 1997
    | Thu 02 Jan 00:00:00 1997
    | Thu 02 Jan 03:04:05 1997
    | Mon 10 Feb 17:32:01 1997
    | Mon 10 Feb 17:32:01 1997
    | Mon 10 Feb 17:32:01 1997
    | Mon 10 Feb 17:32:01 1997
    | Tue 10 Jun 17:32:01 1997
    | Sat 22 Sep 18:19:20 2001
    | Wed 15 Mar 08:14:01 2000
    | Wed 15 Mar 13:14:02 2000
    | Wed 15 Mar 12:14:03 2000
    | Wed 15 Mar 03:14:04 2000
    | Wed 15 Mar 02:14:05 2000
    | Mon 10 Feb 17:32:01 1997
    | Mon 10 Feb 17:32:01 1997
    | Mon 10 Feb 17:32:00 1997
    | Mon 10 Feb 17:32:01 1997
    | Mon 10 Feb 17:32:01 1997
    | Mon 10 Feb 17:32:01 1997
    | Mon 10 Feb 17:32:01 1997
    | Mon 10 Feb 17:32:01 1997
    | Mon 10 Feb 17:32:01 1997
    | Mon 10 Feb 17:32:01 1997
    | Mon 10 Feb 17:32:01 1997
    | Tue 10 Jun 18:32:01 1997
    | Mon 10 Feb 17:32:01 1997
    | Tue 11 Feb 17:32:01 1997
    | Wed 12 Feb 17:32:01 1997
    | Thu 13 Feb 17:32:01 1997
    | Fri 14 Feb 17:32:01 1997
    | Sat 15 Feb 17:32:01 1997
    | Sun 16 Feb 17:32:01 1997
    | Sat 16 Feb 17:32:01 0097
    | Thu 16 Feb 17:32:01 0597
    | Tue 16 Feb 17:32:01 1097
    | Sat 16 Feb 17:32:01 1697
    | Thu 16 Feb 17:32:01 1797
    | Tue 16 Feb 17:32:01 1897
    | Sun 16 Feb 17:32:01 1997
    | Sat 16 Feb 17:32:01 2097
    | Wed 28 Feb 17:32:01 1996
    | Thu 29 Feb 17:32:01 1996
    | Fri 01 Mar 17:32:01 1996
    | Mon 30 Dec 17:32:01 1996
    | Tue 31 Dec 17:32:01 1996
    | Wed 01 Jan 17:32:01 1997
    | Fri 28 Feb 17:32:01 1997
    | Sat 01 Mar 17:32:01 1997
    | Tue 30 Dec 17:32:01 1997
    | Wed 31 Dec 17:32:01 1997
    | Fri 31 Dec 17:32:01 1999
    | Sat 01 Jan 17:32:01 2000
    | Sun 31 Dec 17:32:01 2000
    | Mon 01 Jan 17:32:01 2001
    | Thu 13 Jun 00:00:00 1957
(62 rows)

SET DateStyle TO 'European,ISO';
SET
SHOW DateStyle;
 DateStyle 
-----------
 ISO, DMY
(1 row)

SELECT '' AS "65", d1 AS european_iso FROM TIMESTAMP_TBL;
 65 |     european_iso      
----+-----------------------
    | 1970-01-01 00:00:00
    | 1997-02-10 17:32:01
    | 1997-02-10 17:32:01
    | 1997-02-10 17:32:02
    | 1997-02-10 17:32:01.4
    | 1997-02-10 17:32:01.5
    | 1997-02-10 17:32:01.6
    | 1997-01-02 00:00:00
    | 1997-01-02 03:04:05
    | 1997-02-10 17:32:01
    | 1997-02-10 17:32:01
    | 1997-02-10 17:32:01
    | 1997-02-10 17:32:01
    | 1997-06-10 17:32:01
    | 2001-09-22 18:19:20
    | 2000-03-15 08:14:01
    | 2000-03-15 13:14:02
    | 2000-03-15 12:14:03
    | 2000-03-15 03:14:04
    | 2000-03-15 02:14:05
    | 1997-02-10 17:32:01
    | 1997-02-10 17:32:01
    | 1997-02-10 17:32:00
    | 1997-02-10 17:32:01
    | 1997-02-10 17:32:01
    | 1997-02-10 17:32:01
    | 1997-02-10 17:32:01
    | 1997-02-10 17:32:01
    | 1997-02-10 17:32:01
    | 1997-02-10 17:32:01
    | 1997-02-10 17:32:01
    | 1997-06-10 18:32:01
    | 1997-02-10 17:32:01
    | 1997-02-11 17:32:01
    | 1997-02-12 17:32:01
    | 1997-02-13 17:32:01
    | 1997-02-14 17:32:01
    | 1997-02-15 17:32:01
    | 1997-02-16 17:32:01
    | 0097-02-16 17:32:01
    | 0597-02-16 17:32:01
    | 1097-02-16 17:32:01
    | 1697-02-16 17:32:01
    | 1797-02-16 17:32:01
    | 1897-02-16 17:32:01
    | 1997-02-16 17:32:01
    | 2097-02-16 17:32:01
    | 1996-02-28 17:32:01
    | 1996-02-29 17:32:01
    | 1996-03-01 17:32:01
    | 1996-12-30 17:32:01
    | 1996-12-31 17:32:01
    | 1997-01-01 17:32:01
    | 1997-02-28 17:32:01
    | 1997-03-01 17:32:01
    | 1997-12-30 17:32:01
    | 1997-12-31 17:32:01
    | 1999-12-31 17:32:01
    | 2000-01-01 17:32:01
    | 2000-12-31 17:32:01
    | 2001-01-01 17:32:01
    | 1957-06-13 00:00:00
(62 rows)

SET DateStyle TO 'European,SQL';
SET
SHOW DateStyle;
 DateStyle 
-----------
 SQL, DMY
(1 row)

SELECT '' AS "65", d1 AS european_sql FROM TIMESTAMP_TBL;
 65 |     european_sql      
----+-----------------------
    | 01/01/1970 00:00:00
    | 10/02/1997 17:32:01
    | 10/02/1997 17:32:01
    | 10/02/1997 17:32:02
    | 10/02/1997 17:32:01.4
    | 10/02/1997 17:32:01.5
    | 10/02/1997 17:32:01.6
    | 02/01/1997 00:00:00
    | 02/01/1997 03:04:05
    | 10/02/1997 17:32:01
    | 10/02/1997 17:32:01
    | 10/02/1997 17:32:01
    | 10/02/1997 17:32:01
    | 10/06/1997 17:32:01
    | 22/09/2001 18:19:20
    | 15/03/2000 08:14:01
    | 15/03/2000 13:14:02
    | 15/03/2000 12:14:03
    | 15/03/2000 03:14:04
    | 15/03/2000 02:14:05
    | 10/02/1997 17:32:01
    | 10/02/1997 17:32:01
    | 10/02/1997 17:32:00
    | 10/02/1997 17:32:01
    | 10/02/1997 17:32:01
    | 10/02/1997 17:32:01
    | 10/02/1997 17:32:01
    | 10/02/1997 17:32:01
    | 10/02/1997 17:32:01
    | 10/02/1997 17:32:01
    | 10/02/1997 17:32:01
    | 10/06/1997 18:32:01
    | 10/02/1997 17:32:01
    | 11/02/1997 17:32:01
    | 12/02/1997 17:32:01
    | 13/02/1997 17:32:01
    | 14/02/1997 17:32:01
    | 15/02/1997 17:32:01
    | 16/02/1997 17:32:01
    | 16/02/0097 17:32:01
    | 16/02/0597 17:32:01
    | 16/02/1097 17:32:01
    | 16/02/1697 17:32:01
    | 16/02/1797 17:32:01
    | 16/02/1897 17:32:01
    | 16/02/1997 17:32:01
    | 16/02/2097 17:32:01
    | 28/02/1996 17:32:01
    | 29/02/1996 17:32:01
    | 01/03/1996 17:32:01
    | 30/12/1996 17:32:01
    | 31/12/1996 17:32:01
    | 01/01/1997 17:32:01
    | 28/02/1997 17:32:01
    | 01/03/1997 17:32:01
    | 30/12/1997 17:32:01
    | 31/12/1997 17:32:01
    | 31/12/1999 17:32:01
    | 01/01/2000 17:32:01
    | 31/12/2000 17:32:01
    | 01/01/2001 17:32:01
    | 13/06/1957 00:00:00
(62 rows)

RESET DateStyle;
RESET
--
-- to_timestamp()
--
SELECT to_timestamp('0097/Feb/16 --> 08:14:30', 'YYYY/Mon/DD --> HH:MI:SS');
         to_timestamp         
------------------------------
 0097-02-16 08:14:30+08:05:43
(1 row)

SELECT to_timestamp('97/2/16 8:14:30', 'FMYYYY/FMMM/FMDD FMHH:FMMI:FMSS');
         to_timestamp         
------------------------------
 0097-02-16 08:14:30+08:05:43
(1 row)

SELECT to_timestamp('1985 January 12', 'YYYY FMMonth DD');
      to_timestamp      
------------------------
 1985-01-12 00:00:00+08
(1 row)

SELECT to_timestamp('My birthday-> Year: 1976, Month: May, Day: 16',
                    '"My birthday-> Year" YYYY, "Month:" FMMonth, "Day:" DD');
      to_timestamp      
------------------------
 1976-05-16 00:00:00+08
(1 row)

SELECT to_timestamp('1,582nd VIII 21', 'Y,YYYth FMRM DD');
         to_timestamp         
------------------------------
 1582-08-21 00:00:00+08:05:43
(1 row)

SELECT to_timestamp('15 "text between quote marks" 98 54 45',
                    E'HH24 "\\text between quote marks\\"" YY MI SS');
      to_timestamp      
------------------------
 1998-01-01 15:54:45+08
(1 row)

SELECT to_timestamp('05121445482000', 'MMDDHH24MISSYYYY');
      to_timestamp      
------------------------
 2000-05-12 14:45:48+08
(1 row)

SELECT to_timestamp('2000January09Sunday', 'YYYYFMMonthDDFMDay');
      to_timestamp      
------------------------
 2000-01-09 00:00:00+08
(1 row)

SELECT to_timestamp('97/Feb/16', 'YYMonDD');
psql:sql/horology.sql:324: ERROR:  invalid value "/Fe" for "Mon"
DETAIL:  The given value did not match any of the allowed values for this field.
SELECT to_timestamp('19971116', 'YYYYMMDD');
      to_timestamp      
------------------------
 1997-11-16 00:00:00+08
(1 row)

SELECT to_timestamp('20000-1116', 'YYYY-MMDD');
      to_timestamp       
-------------------------
 20000-11-16 00:00:00+08
(1 row)

SELECT to_timestamp('1997 AD 11 16', 'YYYY BC MM DD');
      to_timestamp      
------------------------
 1997-11-16 00:00:00+08
(1 row)

SELECT to_timestamp('1997 BC 11 16', 'YYYY BC MM DD');
          to_timestamp           
---------------------------------
 1997-11-16 00:00:00+08:05:43 BC
(1 row)

SELECT to_timestamp('9-1116', 'Y-MMDD');
      to_timestamp      
------------------------
 2009-11-16 00:00:00+08
(1 row)

SELECT to_timestamp('95-1116', 'YY-MMDD');
      to_timestamp      
------------------------
 1995-11-16 00:00:00+08
(1 row)

SELECT to_timestamp('995-1116', 'YYY-MMDD');
      to_timestamp      
------------------------
 1995-11-16 00:00:00+08
(1 row)

SELECT to_timestamp('2005426', 'YYYYWWD');
      to_timestamp      
------------------------
 2005-10-15 00:00:00+08
(1 row)

SELECT to_timestamp('2005300', 'YYYYDDD');
      to_timestamp      
------------------------
 2005-10-27 00:00:00+08
(1 row)

SELECT to_timestamp('2005527', 'IYYYIWID');
      to_timestamp      
------------------------
 2006-01-01 00:00:00+08
(1 row)

SELECT to_timestamp('005527', 'IYYIWID');
      to_timestamp      
------------------------
 2006-01-01 00:00:00+08
(1 row)

SELECT to_timestamp('05527', 'IYIWID');
      to_timestamp      
------------------------
 2006-01-01 00:00:00+08
(1 row)

SELECT to_timestamp('5527', 'IIWID');
      to_timestamp      
------------------------
 2006-01-01 00:00:00+08
(1 row)

SELECT to_timestamp('2005364', 'IYYYIDDD');
      to_timestamp      
------------------------
 2006-01-01 00:00:00+08
(1 row)

SELECT to_timestamp('20050302', 'YYYYMMDD');
      to_timestamp      
------------------------
 2005-03-02 00:00:00+08
(1 row)

SELECT to_timestamp('2005 03 02', 'YYYYMMDD');
      to_timestamp      
------------------------
 2005-03-02 00:00:00+08
(1 row)

SELECT to_timestamp(' 2005 03 02', 'YYYYMMDD');
      to_timestamp      
------------------------
 2005-03-02 00:00:00+08
(1 row)

SELECT to_timestamp('  20050302', 'YYYYMMDD');
      to_timestamp      
------------------------
 2005-03-02 00:00:00+08
(1 row)

SELECT to_timestamp('2011-12-18 11:38 AM', 'YYYY-MM-DD HH12:MI PM');
      to_timestamp      
------------------------
 2011-12-18 11:38:00+08
(1 row)

SELECT to_timestamp('2011-12-18 11:38 PM', 'YYYY-MM-DD HH12:MI PM');
      to_timestamp      
------------------------
 2011-12-18 23:38:00+08
(1 row)

SELECT to_timestamp('2011-12-18 11:38 +05',    'YYYY-MM-DD HH12:MI TZH');
      to_timestamp      
------------------------
 2011-12-18 14:38:00+08
(1 row)

SELECT to_timestamp('2011-12-18 11:38 -05',    'YYYY-MM-DD HH12:MI TZH');
      to_timestamp      
------------------------
 2011-12-19 00:38:00+08
(1 row)

SELECT to_timestamp('2011-12-18 11:38 +05:20', 'YYYY-MM-DD HH12:MI TZH:TZM');
      to_timestamp      
------------------------
 2011-12-18 14:18:00+08
(1 row)

SELECT to_timestamp('2011-12-18 11:38 -05:20', 'YYYY-MM-DD HH12:MI TZH:TZM');
      to_timestamp      
------------------------
 2011-12-19 00:58:00+08
(1 row)

SELECT to_timestamp('2011-12-18 11:38 20',     'YYYY-MM-DD HH12:MI TZM');
      to_timestamp      
------------------------
 2011-12-18 19:18:00+08
(1 row)

--
-- Check handling of multiple spaces in format and/or input
--
SELECT to_timestamp('2011-12-18 23:38:15', 'YYYY-MM-DD  HH24:MI:SS');
      to_timestamp      
------------------------
 2011-12-18 03:38:15+08
(1 row)

SELECT to_timestamp('2011-12-18  23:38:15', 'YYYY-MM-DD  HH24:MI:SS');
      to_timestamp      
------------------------
 2011-12-18 23:38:15+08
(1 row)

SELECT to_timestamp('2011-12-18   23:38:15', 'YYYY-MM-DD  HH24:MI:SS');
      to_timestamp      
------------------------
 2011-12-18 23:38:15+08
(1 row)

SELECT to_timestamp('2011-12-18  23:38:15', 'YYYY-MM-DD HH24:MI:SS');
      to_timestamp      
------------------------
 2011-12-18 23:38:15+08
(1 row)

SELECT to_timestamp('2011-12-18  23:38:15', 'YYYY-MM-DD  HH24:MI:SS');
      to_timestamp      
------------------------
 2011-12-18 23:38:15+08
(1 row)

SELECT to_timestamp('2011-12-18  23:38:15', 'YYYY-MM-DD   HH24:MI:SS');
      to_timestamp      
------------------------
 2011-12-18 03:38:15+08
(1 row)

SELECT to_date('2011 12  18', 'YYYY MM DD');
  to_date   
------------
 2011-12-18
(1 row)

SELECT to_date('2011 12  18', 'YYYY MM  DD');
  to_date   
------------
 2011-12-18
(1 row)

SELECT to_date('2011 12  18', 'YYYY MM   DD');
  to_date   
------------
 2011-12-08
(1 row)

SELECT to_date('2011 12 18', 'YYYY  MM DD');
  to_date   
------------
 2011-02-18
(1 row)

SELECT to_date('2011  12 18', 'YYYY  MM DD');
  to_date   
------------
 2011-12-18
(1 row)

SELECT to_date('2011   12 18', 'YYYY  MM DD');
  to_date   
------------
 2011-12-18
(1 row)

--
-- Check errors for some incorrect usages of to_timestamp() and to_date()
--
-- Mixture of date conventions (ISO week and Gregorian):
SELECT to_timestamp('2005527', 'YYYYIWID');
psql:sql/horology.sql:395: ERROR:  invalid combination of date conventions
HINT:  Do not mix Gregorian and ISO week date conventions in a formatting template.
-- Insufficient characters in the source string:
SELECT to_timestamp('19971', 'YYYYMMDD');
psql:sql/horology.sql:398: ERROR:  source string too short for "MM" formatting field
DETAIL:  Field requires 2 characters, but only 1 remain.
HINT:  If your source string is not fixed-width, try using the "FM" modifier.
-- Insufficient digit characters for a single node:
SELECT to_timestamp('19971)24', 'YYYYMMDD');
psql:sql/horology.sql:401: ERROR:  invalid value "1)" for "MM"
DETAIL:  Field requires 2 characters, but only 1 could be parsed.
HINT:  If your source string is not fixed-width, try using the "FM" modifier.
-- Value clobbering:
SELECT to_timestamp('1997-11-Jan-16', 'YYYY-MM-Mon-DD');
psql:sql/horology.sql:404: ERROR:  conflicting values for "Mon" field in formatting string
DETAIL:  This value contradicts a previous setting for the same field type.
-- Non-numeric input:
SELECT to_timestamp('199711xy', 'YYYYMMDD');
psql:sql/horology.sql:407: ERROR:  invalid value "xy" for "DD"
DETAIL:  Value must be an integer.
-- Input that doesn't fit in an int:
SELECT to_timestamp('10000000000', 'FMYYYY');
psql:sql/horology.sql:410: ERROR:  value for "YYYY" in source string is out of range
DETAIL:  Value must be in the range -2147483648 to 2147483647.
-- Out-of-range and not-quite-out-of-range fields:
SELECT to_timestamp('2016-06-13 25:00:00', 'YYYY-MM-DD HH24:MI:SS');
psql:sql/horology.sql:413: ERROR:  date/time field value out of range: "2016-06-13 25:00:00"
SELECT to_timestamp('2016-06-13 15:60:00', 'YYYY-MM-DD HH24:MI:SS');
psql:sql/horology.sql:414: ERROR:  date/time field value out of range: "2016-06-13 15:60:00"
SELECT to_timestamp('2016-06-13 15:50:60', 'YYYY-MM-DD HH24:MI:SS');
psql:sql/horology.sql:415: ERROR:  date/time field value out of range: "2016-06-13 15:50:60"
SELECT to_timestamp('2016-06-13 15:50:55', 'YYYY-MM-DD HH24:MI:SS');  -- ok
      to_timestamp      
------------------------
 2016-06-13 15:50:55+08
(1 row)

SELECT to_timestamp('2016-06-13 15:50:55', 'YYYY-MM-DD HH:MI:SS');
psql:sql/horology.sql:417: ERROR:  hour "15" is invalid for the 12-hour clock
HINT:  Use the 24-hour clock, or give an hour between 1 and 12.
SELECT to_timestamp('2016-13-01 15:50:55', 'YYYY-MM-DD HH24:MI:SS');
psql:sql/horology.sql:418: ERROR:  date/time field value out of range: "2016-13-01 15:50:55"
SELECT to_timestamp('2016-02-30 15:50:55', 'YYYY-MM-DD HH24:MI:SS');
psql:sql/horology.sql:419: ERROR:  date/time field value out of range: "2016-02-30 15:50:55"
SELECT to_timestamp('2016-02-29 15:50:55', 'YYYY-MM-DD HH24:MI:SS');  -- ok
      to_timestamp      
------------------------
 2016-02-29 15:50:55+08
(1 row)

SELECT to_timestamp('2015-02-29 15:50:55', 'YYYY-MM-DD HH24:MI:SS');
psql:sql/horology.sql:421: ERROR:  date/time field value out of range: "2015-02-29 15:50:55"
SELECT to_timestamp('2015-02-11 86000', 'YYYY-MM-DD SSSS');  -- ok
      to_timestamp      
------------------------
 2015-02-11 23:53:20+08
(1 row)

SELECT to_timestamp('2015-02-11 86400', 'YYYY-MM-DD SSSS');
psql:sql/horology.sql:423: ERROR:  date/time field value out of range: "2015-02-11 86400"
SELECT to_date('2016-13-10', 'YYYY-MM-DD');
psql:sql/horology.sql:424: ERROR:  date/time field value out of range: "2016-13-10"
SELECT to_date('2016-02-30', 'YYYY-MM-DD');
psql:sql/horology.sql:425: ERROR:  date/time field value out of range: "2016-02-30"
SELECT to_date('2016-02-29', 'YYYY-MM-DD');  -- ok
  to_date   
------------
 2016-02-29
(1 row)

SELECT to_date('2015-02-29', 'YYYY-MM-DD');
psql:sql/horology.sql:427: ERROR:  date/time field value out of range: "2015-02-29"
SELECT to_date('2015 365', 'YYYY DDD');  -- ok
  to_date   
------------
 2015-12-31
(1 row)

SELECT to_date('2015 366', 'YYYY DDD');
psql:sql/horology.sql:429: ERROR:  date/time field value out of range: "2015 366"
SELECT to_date('2016 365', 'YYYY DDD');  -- ok
  to_date   
------------
 2016-12-30
(1 row)

SELECT to_date('2016 366', 'YYYY DDD');  -- ok
  to_date   
------------
 2016-12-31
(1 row)

SELECT to_date('2016 367', 'YYYY DDD');
psql:sql/horology.sql:432: ERROR:  date/time field value out of range: "2016 367"
--
-- Check behavior with SQL-style fixed-GMT-offset time zone (cf bug #8572)
--
SET TIME ZONE 'America/New_York';
SET
SET TIME ZONE '-1.5';
SET
SHOW TIME ZONE;
    TimeZone    
----------------
 <-01:30>+01:30
(1 row)

SELECT '2012-12-12 12:00'::timestamptz;
        timestamptz        
---------------------------
 2012-12-12 12:00:00-01:30
(1 row)

SELECT '2012-12-12 12:00 America/New_York'::timestamptz;
        timestamptz        
---------------------------
 2012-12-12 15:30:00-01:30
(1 row)

SELECT to_char('2012-12-12 12:00'::timestamptz, 'YYYY-MM-DD HH:MI:SS TZ');
          to_char           
----------------------------
 2012-12-12 12:00:00 -01:30
(1 row)

RESET TIME ZONE;
RESET
--
-- Drop tables that we don't want to keep because they interfere with
-- testing pg_upgrade to v12 and up
--
